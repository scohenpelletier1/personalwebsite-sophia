<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Planets - Sophia Cohen-Pelletier</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: #0a0a0a;
        color: #ffffff;
        line-height: 1.6;
        overflow-x: hidden;
      }

      /* Navigation Menu */
      nav {
        position: fixed;
        top: 0;
        width: 100%;
        background: rgba(10, 10, 10, 0.95);
        backdrop-filter: blur(10px);
        padding: 1.5rem 0;
        z-index: 1000;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      nav ul {
        list-style: none;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 3rem;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 2rem;
      }

      nav a {
        color: #ffffff;
        text-decoration: none;
        font-size: 1.1rem;
        font-weight: 500;
        transition: color 0.3s ease;
        position: relative;
      }

      nav a:hover {
        color: #667eea;
      }

      nav a::after {
        content: '';
        position: absolute;
        bottom: -5px;
        left: 0;
        width: 0;
        height: 2px;
        background: #667eea;
        transition: width 0.3s ease;
      }

      nav a:hover::after {
        width: 100%;
      }

      /* Main Content */
      main {
        margin-top: 80px;
        padding: 4rem 2rem;
        max-width: 1200px;
        margin-left: auto;
        margin-right: auto;
      }

      h1 {
        font-size: 3rem;
        margin-bottom: 1rem;
        text-align: center;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .subtitle {
        text-align: center;
        color: #cccccc;
        font-size: 1.2rem;
        margin-bottom: 3rem;
      }

      /* Loading State */
      .loading {
        text-align: center;
        padding: 3rem;
        color: #cccccc;
        font-size: 1.2rem;
      }

      .loading::after {
        content: '...';
        animation: dots 1.5s steps(4, end) infinite;
      }

      @keyframes dots {
        0%, 20% { content: '.'; }
        40% { content: '..'; }
        60%, 100% { content: '...'; }
      }

      /* Error State */
      .error {
        background: rgba(220, 53, 69, 0.2);
        border: 1px solid rgba(220, 53, 69, 0.5);
        color: #f87171;
        padding: 1.5rem;
        border-radius: 8px;
        text-align: center;
        margin: 2rem 0;
      }

      /* Planets Grid */
      .planets-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 2rem;
        margin-top: 2rem;
      }

      .planet-card {
        background: #1a1a1a;
        border-radius: 12px;
        padding: 2rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
        transition: transform 0.3s ease, border-color 0.3s ease;
      }

      .planet-card:hover {
        transform: translateY(-5px);
        border-color: #667eea;
      }

      .planet-card h3 {
        font-size: 1.8rem;
        margin-bottom: 1rem;
        color: #667eea;
      }

      .planet-card p {
        color: #cccccc;
        margin-bottom: 0.5rem;
      }

      .planet-field {
        margin-bottom: 0.75rem;
      }

      .planet-field strong {
        color: #ffffff;
        margin-right: 0.5rem;
      }

      .planet-field-value {
        color: #cccccc;
      }

      .empty-state {
        text-align: center;
        padding: 4rem 2rem;
        color: #cccccc;
      }

      .empty-state h2 {
        font-size: 2rem;
        margin-bottom: 1rem;
        color: #667eea;
      }

      /* Add Planet Button */
      .add-planet-btn {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 1rem 2rem;
        font-size: 1.1rem;
        font-weight: 600;
        border-radius: 8px;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        display: block;
        margin: 0 auto 2rem;
      }

      .add-planet-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
      }

      .add-planet-btn:active {
        transform: translateY(0);
      }

      /* Modal Overlay */
      .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(5px);
        z-index: 2000;
        align-items: center;
        justify-content: center;
        padding: 2rem;
      }

      .modal-overlay.active {
        display: flex;
      }

      .modal-content {
        background: #1a1a1a;
        border-radius: 12px;
        padding: 2rem;
        max-width: 600px;
        width: 100%;
        max-height: 90vh;
        overflow-y: auto;
        border: 1px solid rgba(255, 255, 255, 0.1);
        position: relative;
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
      }

      .modal-header h2 {
        font-size: 2rem;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin: 0;
      }

      .close-btn {
        background: transparent;
        border: none;
        color: #ffffff;
        font-size: 2rem;
        cursor: pointer;
        padding: 0;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 4px;
        transition: background 0.2s ease;
      }

      .close-btn:hover {
        background: rgba(255, 255, 255, 0.1);
      }

      .form-group {
        margin-bottom: 1.5rem;
      }

      .form-group label {
        display: block;
        margin-bottom: 0.5rem;
        color: #ffffff;
        font-weight: 500;
      }

      .form-group input,
      .form-group textarea {
        width: 100%;
        padding: 0.875rem;
        background: #0a0a0a;
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 8px;
        color: #ffffff;
        font-family: inherit;
        font-size: 1rem;
        transition: border-color 0.3s ease, box-shadow 0.3s ease;
      }

      .form-group input:focus,
      .form-group textarea:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      .form-group textarea {
        resize: vertical;
        min-height: 100px;
      }

      .form-group input[type="checkbox"] {
        width: auto;
        margin: 0;
        cursor: pointer;
      }

      .form-actions {
        display: flex;
        gap: 1rem;
        margin-top: 2rem;
      }

      .submit-btn {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 1rem 2rem;
        font-size: 1.1rem;
        font-weight: 600;
        border-radius: 8px;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        flex: 1;
      }

      .submit-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
      }

      .submit-btn:active {
        transform: translateY(0);
      }

      .submit-btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }

      .cancel-btn {
        background: #2a2a2a;
        color: white;
        border: none;
        padding: 1rem 2rem;
        font-size: 1.1rem;
        font-weight: 600;
        border-radius: 8px;
        cursor: pointer;
        transition: background 0.2s ease;
        flex: 1;
      }

      .cancel-btn:hover {
        background: #3a3a3a;
      }

      .success-message {
        background: rgba(40, 167, 69, 0.2);
        border: 1px solid rgba(40, 167, 69, 0.5);
        color: #4ade80;
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1rem;
        text-align: center;
      }

      /* Mobile Responsive */
      @media (max-width: 768px) {
        nav ul {
          gap: 1.5rem;
          flex-wrap: wrap;
          padding: 0 1rem;
        }

        h1 {
          font-size: 2rem;
        }

        main {
          padding: 2rem 1rem;
        }

        .planets-grid {
          grid-template-columns: 1fr;
        }

        .add-planet-btn {
          width: 100%;
          font-size: 1rem;
          padding: 0.875rem 1.5rem;
        }

        .modal-overlay {
          padding: 1rem;
        }

        .modal-content {
          padding: 1.5rem;
        }

        .modal-header h2 {
          font-size: 1.5rem;
        }

        .form-actions {
          flex-direction: column;
        }

        .submit-btn,
        .cancel-btn {
          width: 100%;
        }
      }
    </style>
  </head>
  <body>
    <!-- Navigation Menu -->
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="index.html#about">About</a></li>
        <li><a href="index.html#projects">Projects</a></li>
        <li><a href="index.html#contact">Contact</a></li>
        <li><a href="planets.html">Planets</a></li>
      </ul>
    </nav>

    <!-- Main Content -->
    <main>
      <h1>Planets Database</h1>
      <p class="subtitle">Exploring the planets collection from Firestore</p>
      
      <button class="add-planet-btn" id="addPlanetBtn">+ Add New Planet</button>
      
      <div id="loading" class="loading">Loading planets</div>
      <div id="error" class="error" style="display: none;"></div>
      <div id="planetsContainer" class="planets-grid" style="display: none;"></div>
    </main>

    <!-- Add Planet Modal -->
    <div class="modal-overlay" id="addPlanetModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Add New Planet</h2>
          <button class="close-btn" id="closeModalBtn">&times;</button>
        </div>
        <div id="modalMessage"></div>
        <form id="addPlanetForm">
          <div class="form-group">
            <label for="planetName">Planet Name *</label>
            <input type="text" id="planetName" name="name" required placeholder="e.g., Earth">
          </div>
          <div class="form-group">
            <label for="planetDiameter">Diameter (miles)</label>
            <input type="number" id="planetDiameter" name="diameter" step="0.01" placeholder="e.g., 7926">
          </div>
          <div class="form-group">
            <label for="planetType">Planet Type</label>
            <input type="text" id="planetType" name="planetType" placeholder="e.g., Terrestrial, Gas Giant">
          </div>
          <div class="form-group">
            <label for="planetIsHabitable" style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
              <input type="checkbox" id="planetIsHabitable" name="isHabitable" style="width: auto; cursor: pointer;">
              <span>Is Habitable</span>
            </label>
          </div>
          <div class="form-actions">
            <button type="button" class="cancel-btn" id="cancelBtn">Cancel</button>
            <button type="submit" class="submit-btn" id="submitPlanetBtn">Add Planet</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
      // Import Firebase functions
      import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
      import { getFirestore, collection, getDocs, addDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

      // Your Firebase configuration
      // TODO: Replace this with your actual Firebase config from Firebase Console
      // Go to Project Settings > General > Your apps > Firebase SDK snippet > Config
      const firebaseConfig = {
        apiKey: "YOUR_API_KEY",
        authDomain: "personalwebsite-sophia.firebaseapp.com",
        projectId: "personalwebsite-sophia",
        storageBucket: "personalwebsite-sophia.appspot.com",
        messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
        appId: "YOUR_APP_ID"
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      // Get DOM elements
      const loadingEl = document.getElementById('loading');
      const errorEl = document.getElementById('error');
      const planetsContainer = document.getElementById('planetsContainer');
      const addPlanetBtn = document.getElementById('addPlanetBtn');
      const addPlanetModal = document.getElementById('addPlanetModal');
      const closeModalBtn = document.getElementById('closeModalBtn');
      const cancelBtn = document.getElementById('cancelBtn');
      const addPlanetForm = document.getElementById('addPlanetForm');
      const submitPlanetBtn = document.getElementById('submitPlanetBtn');
      const modalMessage = document.getElementById('modalMessage');

      // Function to display planets
      async function displayPlanets() {
        try {
          // Hide error, show loading
          errorEl.style.display = 'none';
          loadingEl.style.display = 'block';
          planetsContainer.style.display = 'none';

          // Get all documents from the 'planets' collection
          const planetsCollection = collection(db, 'planets');
          const planetsSnapshot = await getDocs(planetsCollection);

          // Hide loading
          loadingEl.style.display = 'none';

          if (planetsSnapshot.empty) {
            // No planets found
            planetsContainer.innerHTML = `
              <div class="empty-state">
                <h2>No Planets Found</h2>
                <p>The planets collection is empty. Add some planets to your Firestore database to see them here.</p>
              </div>
            `;
            planetsContainer.style.display = 'block';
            return;
          }

          // Display planets
          planetsContainer.innerHTML = '';
          planetsSnapshot.forEach((doc) => {
            const planetData = doc.data();
            const planetId = doc.id;

            // Create planet card
            const planetCard = document.createElement('div');
            planetCard.className = 'planet-card';

            // Build card content
            let cardContent = `<h3>${planetData.name || planetId}</h3>`;
            
            // Define field order for display: name, diameter (mi), isHabitable, planetType
            const fieldOrder = ['name', 'diameter', 'isHabitable', 'planetType'];
            const labelMap = {
              name: 'Name',
              diameter: 'Diameter (mi)',
              isHabitable: 'Habitable',
              planetType: 'Planet Type'
            };
            
            // Display fields in database order
            for (const key of fieldOrder) {
              if (key === 'name') continue; // Name is already in the title
              
              const value = planetData[key];
              if (value === undefined || value === null) continue;
              
              let displayValue;
              
              // Format different data types
              if (typeof value === 'boolean') {
                displayValue = value ? 'Yes' : 'No';
              } else if (typeof value === 'number') {
                // Format numbers with commas for readability
                displayValue = value.toLocaleString();
              } else if (typeof value === 'object') {
                displayValue = JSON.stringify(value, null, 2);
              } else {
                displayValue = String(value);
              }

              cardContent += `
                <div class="planet-field">
                  <strong>${labelMap[key] || (key.charAt(0).toUpperCase() + key.slice(1).replace(/_/g, ' '))}:</strong>
                  <span class="planet-field-value">${displayValue}</span>
                </div>
              `;
            }
            
            // Display any additional fields that might exist in the database
            for (const [key, value] of Object.entries(planetData)) {
              if (!fieldOrder.includes(key)) {
                let displayValue;
                
                if (value === null || value === undefined) {
                  displayValue = 'N/A';
                } else if (typeof value === 'object') {
                  displayValue = JSON.stringify(value, null, 2);
                } else if (typeof value === 'boolean') {
                  displayValue = value ? 'Yes' : 'No';
                } else {
                  displayValue = String(value);
                }

                cardContent += `
                  <div class="planet-field">
                    <strong>${key.charAt(0).toUpperCase() + key.slice(1).replace(/_/g, ' ')}:</strong>
                    <span class="planet-field-value">${displayValue}</span>
                  </div>
                `;
              }
            }

            planetCard.innerHTML = cardContent;
            planetsContainer.appendChild(planetCard);
          });

          // Show planets container
          planetsContainer.style.display = 'grid';

        } catch (error) {
          console.error('Error fetching planets:', error);
          loadingEl.style.display = 'none';
          errorEl.textContent = `Error loading planets: ${error.message}. Please check your Firebase configuration.`;
          errorEl.style.display = 'block';
        }
      }

      // Modal functions
      function openModal() {
        addPlanetModal.classList.add('active');
        modalMessage.innerHTML = '';
        addPlanetForm.reset();
      }

      function closeModal() {
        addPlanetModal.classList.remove('active');
        modalMessage.innerHTML = '';
        addPlanetForm.reset();
      }

      // Event listeners for modal
      addPlanetBtn.addEventListener('click', openModal);
      closeModalBtn.addEventListener('click', closeModal);
      cancelBtn.addEventListener('click', closeModal);

      // Close modal when clicking outside
      addPlanetModal.addEventListener('click', function(e) {
        if (e.target === addPlanetModal) {
          closeModal();
        }
      });

      // Handle form submission
      addPlanetForm.addEventListener('submit', async function(e) {
        e.preventDefault();

        // Disable submit button
        submitPlanetBtn.disabled = true;
        submitPlanetBtn.textContent = 'Adding...';
        modalMessage.innerHTML = '';

        try {
          // Collect form data
          const formData = new FormData(addPlanetForm);
          const planetData = {};

          // Define field order to match database order
          const fieldOrder = ['name', 'diameter', 'planetType', 'isHabitable'];
          
          // Convert form data to object, maintaining order and filtering out empty values
          for (const key of fieldOrder) {
            if (key === 'isHabitable') {
              // Handle checkbox (boolean) - always set, even if false
              planetData[key] = formData.has(key);
            } else {
              const value = formData.get(key);
              if (value) {
                const trimmedValue = value.trim();
                if (trimmedValue !== '') {
                  if (key === 'diameter') {
                    // Convert diameter to number
                    const numValue = Number(trimmedValue);
                    if (!isNaN(numValue)) {
                      planetData[key] = numValue;
                    }
                  } else {
                    planetData[key] = trimmedValue;
                  }
                }
              }
            }
          }

          // Ensure name exists
          if (!planetData.name) {
            throw new Error('Planet name is required');
          }

          // Add document to Firestore
          const planetsCollection = collection(db, 'planets');
          await addDoc(planetsCollection, planetData);

          // Show success message
          modalMessage.innerHTML = '<div class="success-message">Planet added successfully! Refreshing list...</div>';

          // Close modal after a short delay
          setTimeout(() => {
            closeModal();
            // Refresh the planets list
            displayPlanets();
          }, 1000);

        } catch (error) {
          console.error('Error adding planet:', error);
          modalMessage.innerHTML = `<div class="error">Error adding planet: ${error.message}</div>`;
        } finally {
          submitPlanetBtn.disabled = false;
          submitPlanetBtn.textContent = 'Add Planet';
        }
      });

      // Load planets when page loads
      displayPlanets();
    </script>
  </body>
</html>
